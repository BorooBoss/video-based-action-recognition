<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Recognizer</title>
</head>
<body>
  <h1>Image Recognizer</h1>

  <form id="recognize-form" enctype="multipart/form-data">
    <label>Choose model:</label>
    <select name="model">
      <option value="google/paligemma2-3b-pt-224">paligemma2-3b-pt-224</option>
      <option value="google/paligemma2-3b-mix-224">paligemma2-3b-mix-224</option>
      <option value="microsoft/Florence-2-base">florence-2-base</option>
    </select>

    <br><br>

    <label>Prompt:</label>
    <input type="text" name="prompt" placeholder="describe the image">

    <br><br>

    <label>Image:</label>
    <input type="file" name="image" required>

    <br><br>

    <button type="submit">Recognize</button>
  </form>

  <hr>

  <h3>Result:</h3>
  <pre id="result-box">No result yet.</pre>

  <script>
    const form = document.getElementById('recognize-form');
    const resultBox = document.getElementById('result-box');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const formData = new FormData(form);
      resultBox.textContent = "Processing...";

      try {
        const response = await fetch('/recognizer/recognize/', {
          method: 'POST',
          body: formData
        });

        const data = await response.json();

        if (data.result) {
          resultBox.textContent = `Model: ${data.model}\nPrompt: ${data.prompt}\nResult: ${data.result}`;
        } else {
          resultBox.textContent = `Error: ${data.error || 'Unknown error'}`;
        }

      } catch (err) {
        resultBox.textContent = `Request failed: ${err}`;
      }
    });
  </script>
</body>
</html>
